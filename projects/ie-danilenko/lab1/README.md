# Лабораторная работа №1: Развёртывание и эмпирический анализ LLM

## Описание задания

В рамках данной лабораторной работы было проведено тестирование трех языковых моделей из разных семейств с целью анализа их производительности и качества генерации текста. Тестирование проводилось с использованием различных типов промптов и параметров генерации. В качестве движка использовалось Ollama.

**Цель работы**: Сравнить производительность различных LLM моделей на задачах генерации, классификации и извлечения информации.

## Использованные технологии и модели

### LLM модели
- **Qwen2.5:7b** (семейство Qwen)
- **Llama3.1:8b** (семейство Llama)  
- **Mistral:7b** (семейство Mistral)

### Технологии
- **Ollama** - платформа для развертывания LLM
- **OpenAI API** - для взаимодействия с моделями
- **Python** - язык программирования
- **tabulate** - для форматирования таблиц

### Библиотеки
- `openai>=1.0.0` - клиент для работы с API
- `tabulate>=0.9.0` - форматирование таблиц

## Результаты работы

### Статистика по моделям

| Модель      | Среднее время | Средние токены | Скорость    |
|-------------|---------------|----------------|-------------|
| llama3.1:8b | 7.5с          | 152            | 20.3 ток/с  |
| qwen2.5:7b  | 8.7с          | 183            | 21.0 ток/с  |
| mistral:7b  | 10.0с         | 229            | 22.9 ток/с  |

### Сравнение режимов

| Метрика          | Basic | Tuned | Разница |
|------------------|-------|-------|---------|
| Время (с)        | 9.4   | 8.0   | -1.4    |
| Токены           | 180   | 195   | +15     |
| Скорость (ток/с) | 19.1  | 24.3  | +5.2    |

### Статистика по типам промптов

| Тип промпта       | Среднее время | Средние токены | Скорость    |
|-------------------|---------------|----------------|-------------|
| P2: Классификация | 2.0с          | 41             | 20.9 ток/с  |
| P3: Извлечение    | 11.1с         | 246            | 22.2 ток/с  |
| P1: Генерация     | 13.1с         | 277            | 21.1 ток/с  |

### Таблица со сравнением результатов моделей:

| Задача | Модель | Вариант | Время (сек) | Выходные токены | Скорость (токенов/сек) | Ответ |
|--------|--------|---------|-------------|-----------------|----------------------|-------|
| P1_generation | qwen2.5:7b | basic | 14.51 | 256 | 17.6 | Уважаемый [ФИО клиента],<br/><br/>Благодарим Вас за недавнюю покупку нашего продукта. Мы ценим Ваш выбор и надеемся, что нашему предложению была дана высокая оценка.<br/><br/>Ваш заказ уже обрабатывается нашими специалистами: он поставляется оперативно, а также мы приступили к рассмотрению Ваших льготных условий. После завершения всех процедур, Вы встретите от нас оповещение о готовности Вашего заказа.<br/><br/>Наша команда всегда готова обеспечить поддержку на протяжении всего процесса использования нашего продукта. Наши контактные лица при необходимости смогут ответить на все Ваши вопросы и проконсультировать по вопросам эксплуатации и обслуживания. Вы также можете использовать специализированный шрифт поддержки, который не нуждается в регистрации.<br/><br/>Мы стараемся предложить клиентам весь спектр возможных услуг над их ожиданиями. Это может быть техническая поддержка по электронной почте или |
| P1_generation | qwen2.5:7b | tuned | 8.55 | 208 | 24.3 | Уважаемый [Имя клиента],<br/><br/>Благодарим Вас за недавнюю покупку нашего продукта! Ваш выбор говорит о доверии к нашей компании, и мы ценим это очень.<br/><br/>Мы всегда готовы предоставить Вам профессиональную поддержку. Если у вас возникнут вопросы или потребуется помощь, пожалуйста, не стесняйтесь обращаться по телефону [номер телефона] или электронной почте [адрес электронной почты].<br/><br/>Кроме того, хотели бы предложить Вам воспользоваться нашими дополнительными услугами. Мы предлагаем техническую поддержку, обучающие материалы и специальные скидки на будущие покупки.<br/><br/>Мы стремимся обеспечить вам комфортное использование нашего продукта и рады были бы услышать ваши отзывы о нем.<br/><br/>С уважением,<br/>[Ваше имя]<br/>[Должность] |
| P2_classification | qwen2.5:7b | basic | 1.22 | 13 | 10.6 | 1) Billing<br/>2) Tech support<br/>3) Sales |
| P2_classification | qwen2.5:7b | tuned | 0.55 | 13 | 23.5 | 1) Billing<br/>2) Tech support<br/>3) Sales |
| P3_extraction | qwen2.5:7b | basic | 12.28 | 256 | 20.8 | Ключевые факты из описания:<br/><br/>1. **Название устройства:** iPhone Air.<br/>2. **Производитель:** Apple Inc.<br/>3. **Поколение устройства:** 19-е поколение (самый новый под текущим названием).<br/>4. **Дата анонса:** 9 сентября 2025 года, во время мероприятия в Apple Park, Купертино, штат Калифорния.<br/>5. **Состояние замены модели Plus:** Переименованный вариант с акцентом на легкий дизайн и улучшенные функции.<br/>6. **Эксплуатационная характеристика:** Толщина составляет 0,22 дюйма (5,64 мм), что делает его самым тонким из созданных моделей iPhone, превосходя даже модель iPhone 6 с толщиной 0,27 дюймов (6,9 мм).<br/>7. **Модели для сравнения:** Принадлежит к серии iPhone вместе с более доступной модификацией iPhone 17 и более дорогими моделями |
| P3_extraction | qwen2.5:7b | tuned | 15.11 | 352 | 23.3 | Из описания можно извлечь следующую ключевую информацию:<br/><br/>1. **Название и производитель**: iPhone Air — смартфон компании Apple Inc.<br/>2. **Поколение**: Это девятнадцатое поколение iPhone (iPhone 19).<br/>3. **Дата анонса**: 9 сентября 2025 года, в Apple Park, Купертино, штат Калифорния.<br/>4. **Сопутствующие модели**: Анонсированы также более дешевая модель iPhone 17 и более дорогие модели iPhone 17 Pro и 17 Pro Max.<br/>5. **Акцент на дизайн**: Переименованная версия с акцентом на легкий дизайн и улучшенные функции, заменяющая серию Plus.<br/>6. **Технические характеристики**:<br/>   - Толщина: 0,22 дюйма (5,64 мм) — самый тонкий iPhone из когда-либо созданных.<br/>   - Превосходит iPhone 6 по толщине (0,27 дюйма или 6,9 мм).<br/>7. **Технические компоненты**: Модем C1X и сетевой чип N1.<br/>8. **Цена**: Начальная цена в США составляет 999 долларов.<br/><br/>Эта информация охватывает основные аспекты анонса iPhone Air, включая его характеристики, цену и конкурентоспособность на рынке. |
| P1_generation | llama3.1:8b | basic | 15.15 | 256 | 16.9 | Здравствуйте [имя клиента],<br/><br/>Прежде всего мы хотели бы выразить нашу искреннюю благодарность за приобретение нашего продукта! Мы рады, что вы выбрали наше решение для своих бизнес-необходимостей.<br/><br/>Наши продукты предназначены для обеспечения простоты и инновационности в вашей работе, поэтому мы хотим быть уверены: вы знаете, когда и как обращаться к нашей команде в случае появления вопросов или проблем. Вспомогательные материалы, FAQ и поддержка находятся в доступе:<br/><br/>- Официальный сайт компании: [ссылка на сайте]<br/>- Блоги (обзоры обновлений): [наименование блога]<br/>- Твиттер (@имя аккаунта)<br/><br/>Мы готовы помочь вам с дальнейшим использованием нашего продукта и решить такие задачи, как:<br/><br/> * Конфигурация для ваших бизнес-требований<br/> * Техподдержка непосредственно у нас<br/>* Расширение функциональности, доступное в качестве дополнительных услуг!<br/><br/>Если вы заинтересованы или просто хотите |
| P1_generation | llama3.1:8b | tuned | 10.26 | 245 | 23.9 | Дорогой клиент,<br/><br/>Благодарим Вас за выбор нашего продукта! Мы рады, что Вы доверили нам свою бизнес-необходимость.<br/><br/>Если у Вас возникли вопросы или проблемы с использованием нашего продукта, не стесняйтесь обращаться к нашему техническому отделу. Мы всегда готовы помочь и ответить на любые Ваши вопросы по электронной почте [support@yourcompany.com](mailto:support@yourcompany.com) или по телефону +7 (800) 123-45-67.<br/><br/>Нам также хотелось бы предложить Вам ряд дополнительных услуг, которые могут быть интересны для Вашего бизнеса. Наши специалисты готовы помочь Вам выбрать наиболее подходящую услугу и ее настроек для Вашей компании.<br/><br/>Пожалуйста, свяжитесь с нами, чтобы узнать больше о наших предложениях. Мы всегда рады видеть наших клиентов в гости!<br/><br/>С уважением,<br/><br/>[Ваше имя]<br/>[Ваша фамилия]<br/>[Должность]<br/>[Название вашей компании] |
| P2_classification | llama3.1:8b | basic | 1.30 | 17 | 13.1 | 1) Tech support, 2) Tech support, 3) Sales. |
| P2_classification | llama3.1:8b | tuned | 0.57 | 13 | 22.7 | 1. Billing<br/>2. Tech support<br/>3. Sales |
| P3_extraction | llama3.1:8b | basic | 12.44 | 256 | 20.6 | Новости о смартфонах: <br/><br/>- Национальная цена на iPhoneAir - 999$<br/>- Эта модель является двадцать третьей по счёту.<br/><br/>iPhone с 2025 год. Каждые 4 года производят как минимум одну новую версию iPhone (к примеру: в 2021 было только так себе 15 версия, то есть между теми две 30-миллиардами долларов -версий в 2016-20). Это первый раз они не сделали смартфона на базе iOS13 (производили версию iPhone с этой программным обеспечением только после двух десятилетий). Очевидно, что теперь уже создают смартфоны на их новую операционную систему iPhone OS17 (кроме моделей Pro).<br/>Это iPhone девятнадцатое поколение.<br/>Толщина этой модели 5.64 мм.  <br/>Новейший прототип представляет собой усовершенствование старой модель серии Plus, а также включает много других функциональных отличий от старого.<br/><br/>Новая версия будет продаваться вместе с iPhone 17 и iOS17, но эта вер |
| P3_extraction | llama3.1:8b | tuned | 5.15 | 122 | 23.7 | Ключевые факты об iPhone Air:<br/><br/>* Разработан и продается Apple Inc.<br/>* Пятнадцатое поколение iPhone<br/>* Представлен вместе с другими моделями iPhone на мероприятии Appel Park, Купертино, 9 сентября 2025 года<br/>* Подразделение Plus заменено на iPhone Air, со значением на легкий дизайн и улучшенные функции.<br/>* Толщина: 0,22 дюйма (5,64 мм).<br/>* Начальная цена в США составляет $999. |
| P1_generation | mistral:7b | basic | 12.86 | 256 | 19.9 |  Гражданин (ФИО клиента),<br/><br/>С наивысшими почетами приветствую Вас! Я представляю из себя сотрудника компании «Нашпродукт», мы уже давно гордимся тем, что вы заслужили должное место среди наших клиентов. Благодарим Вас за покупку Нашего продукта, которая стала январским началом 20xx года в компании «Нашпродукт».<br/><br/>Мы рады тому, что Вы стал частью нашей сообщества потребителей. В нашем опыте поддержки, не только сразу после приобретения продукта, но и во время использования его в процессе Вашей работы мы стремимся к удобству, быстродействию и качеству проведения работы. Для решения попавшихся вопросов наш сервисный центр доступен 24 часа в сутки, отвеча |
| P1_generation | mistral:7b | tuned | 17.44 | 440 | 25.2 |  Господа Клиент!<br/><br/>Желаю Вам приветствия и успехов в своей деятельности!<br/><br/>С восторгом обращаюсь к Вам с личными пожеланиями, связанными с тем, что Вы стали нашим сторонником и приобрели продукт нашего производства. Мы очень благодарны за Вашу доверие к нашей компании и рады, что мойтовары попали в Ваши руки.<br/><br/>Вам необходимо знать, что мы всегда готовы предоставлять поддержку и консультации в любое время по вопросам, связанным с нашим продуктом. Производительная команда и опытные специалисты нашей компании будут рады помочь Вам в решении возникающих вопросов или задач.<br/><br/>Кроме того, мы предлагаем дополнительные услуги по сервисному обслуживанию и поддержке продукта, которые могут быть полезны для Вашей компании. Мы готовы разработать индивидуальный план сотрудничества, который будет оптимальным для Вас в зависимости от Ваших конкретных нужд и требований.<br/><br/>Желаю Вам успехов в использовании нашего продукта и рады, что моя компания может быть полезной для Вашей деятельности. Пожалуйста, не думайте дважды и обращайтесь к нам с вопросами или предложениями в любое время.<br/><br/>С уважением,<br/>[Ваше имя]<br/>[Название компании] |
| P2_classification | mistral:7b | basic | 4.40 | 95 | 21.6 |  1) Billing: 'Я не понимаю откуда в чеке взялась пятая позиция. Я покупал всего 4 товара'<br/>2) Tech support: 'Как настроить двухфакторную аутентификацию?'<br/>3) Sales: 'Предоставьте торговое предложение для Университета ИТМО' |
| P2_classification | mistral:7b | tuned | 3.70 | 95 | 25.7 |  1) Billing: 'Я не понимаю откуда в чеке взялась пятая позиция. Я покупал всего 4 товара'<br/>2) Tech support: 'Как настроить двухфакторную аутентификацию?'<br/>3) Sales: 'Предоставьте торговое предложение для Университета ИТМО' |
| P3_extraction | mistral:7b | basic | 10.53 | 217 | 20.6 |  Информация выдержканова:<br/>- Продукт: iPhone Air, девелопед и продаваемый компанией Apple Inc.<br/>- Поколение: девятнадцатое поколение iPhone.<br/>- Анонсирован: на мероприятии Apple в Apple Park, 9 сентября 2025 года.<br/>- Замена серии: Plus серии, с акцентом на легкий дизайн и улучшенные функции.<br/>- Толщина: 0,22 дюйма(5,64 мм), (связанное с информацией о самых тонких iPhones произведенных)<br/>- Тарагдная цена в США: $999.<br/>- В томже мероприятии были анонсированы новые модем C1X и сетевой чип N1. |
| P3_extraction | mistral:7b | tuned | 10.89 | 270 | 24.8 |  - Смартфон iPhone Air является девятнадцатым поколением устройства разработанного и продаваемого компанией Apple Inc.<br/>- Этот смартфон был анонсирован на мероприятии Apple в Apple Park, Купертино, Калифорния, 9 сентября 2025 года вместе с iPhone 17, iPhone 17 Pro и iPhone 17 Pro Max.<br/>- iPhone Air заменил серию Plus и имеет акцент на легкий дизайн и улучшенные функции.<br/>- Были также анонсированы модем C1X и сетевой чип N1.<br/>- iPhone Air имеет толщину 0,22 дюйма (5,64 мм), что делает его самым тонким iPhone из когда-либо созданных, превосходящим iPhone 6 по толщине на 0,05 дюйма (6,9 мм).<br/>- Цена начального iPhone Air в США составляет 999 долларов. |

## Выводы

### Анализ производительности моделей

1. **Llama3.1:8b** показала наилучшую производительность по времени генерации (7.5с в среднем)
2. **Qwen2.5:7b** продемонстрировала сбалансированные показатели (8.7с, 183 токена)
3. **Mistral:7b** генерирует больше токенов (229 в среднем), но требует больше времени (10.0с)

### Влияние параметров

- **Tuned режим** показал улучшение скорости генерации на 5.2 токена/сек
- Настроенные параметры привели к увеличению количества токенов на 15 (+8.3%)
- Время генерации сократилось на 1.4 секунды (-14.9%)

### Анализ по типам задач

- **Классификация** (P2) - самая быстрая задача (2.0с, 41 токен)
- **Извлечение** (P3) - средняя сложность (11.1с, 246 токенов)
- **Генерация** (P1) - самая ресурсоемкая (13.1с, 277 токенов)

### Основные выводы

1. **Llama3.1:8b** является наиболее эффективной моделью для быстрой генерации
2. **Mistral:7b** лучше подходит для задач, требующих развернутых ответов
3. **Qwen2.5:7b** представляет собой сбалансированный выбор
4. Настройка параметров значительно улучшает производительность
5. Классификация является наиболее простой задачей для всех моделей

## Инструкция по запуску

### 1. Установка зависимостей

```bash
cd source
pip install -r requirements.txt
```

### 2. Установка и настройка Ollama

```bash
# Установка Ollama (macOS)
curl -fsSL https://ollama.ai/install.sh | sh

# Или через Homebrew
brew install ollama
```

### 3. Развертывание моделей

```bash
# Запуск Ollama сервера
ollama serve

# В другом терминале - загрузка моделей
ollama pull qwen2.5:7b
ollama pull llama3.1:8b  
ollama pull mistral:7b
```

### 4. Запуск анализа

```bash
python main.py
```

### 5. Просмотр результатов

После выполнения анализа результаты будут сохранены в директории `results/`:
- `raw_results.json` - сырые данные всех тестов
- `comparison_table.md` - таблица сравнения результатов